Search.setIndex({"docnames": ["index"], "filenames": ["index.rst"], "titles": ["Use Deep Learning in Data Assimilation"], "terms": {"import": 0, "note": 0, "background": 0, "state": 0, "x0": 0, "xb": 0, "must": 0, "1d": 0, "2d": 0, "tensor": 0, "shape": 0, "batch": 0, "size": 0, "dimens": 0, "i": 0, "option": 0, "onli": 0, "avail": 0, "3d": 0, "variat": 0, "var": 0, "algorithm": 0, "observ": 0, "measur": 0, "y": 0, "The": 0, "number": 0, "kalman": 0, "filter": 0, "kf": 0, "ensembl": 0, "enkf": 0, "4d": 0, "least": 0, "1": 0, "thi": 0, "2": 0, "A": 0, "callabl": 0, "code": 0, "object": 0, "m": 0, "abl": 0, "handl": 0, "input": 0, "x": 0, "output": 0, "time": 0, "window": 0, "sequenc": 0, "length": 0, "h": 0, "could": 0, "either": 0, "If": 0, "default": 0, "all": 0, "except": 0, "correspond": 0, "other": 0, "matrix": 0, "map": 0, "space": 0, "notic": 0, "would": 0, "approxim": 0, "jacobian": 0, "method": 0, "That": 0, "might": 0, "caus": 0, "unexpect": 0, "error": 0, "due": 0, "incorrect": 0, "recommend": 0, "python": 0, "packag": 0, "provid": 0, "flexibl": 0, "user": 0, "friendli": 0, "framework": 0, "perform": 0, "neural": 0, "network": 0, "variou": 0, "includ": 0, "design": 0, "simplifi": 0, "process": 0, "configur": 0, "execut": 0, "case": 0, "make": 0, "easier": 0, "research": 0, "practition": 0, "appli": 0, "techniqu": 0, "scientif": 0, "engin": 0, "problem": 0, "paramet": 0, "contain": 0, "class": 0, "specifi": 0, "builder": 0, "casebuild": 0, "executor": 0, "implement": 0, "_executor": 0, "kalman_filt": 0, "For": 0, "more": 0, "inform": 0, "pleas": 0, "refer": 0, "document": 0, "case_nam": 0, "str": 0, "none": 0, "dict": 0, "ani": 0, "conveni": 0, "wai": 0, "set": 0, "up": 0, "name": 0, "case_": 0, "current_timestamp": 0, "dictionari": 0, "an": 0, "instanc": 0, "type": 0, "set_paramet": 0, "self": 0, "valu": 0, "set_algorithm": 0, "set_devic": 0, "devic": 0, "cpu": 0, "gpu": 0, "comput": 0, "set_forward_model": 0, "forward_model": 0, "torch": 0, "_generictensor": 0, "transit": 0, "function": 0, "set_output_sequence_length": 0, "output_sequence_length": 0, "int": 0, "forward": 0, "model": 0, "set_observation_model": 0, "observation_model": 0, "set_background_covariance_matrix": 0, "background_covariance_matrix": 0, "covari": 0, "b": 0, "set_observation_covariance_matrix": 0, "observation_covariance_matrix": 0, "r": 0, "set_background_st": 0, "background_st": 0, "initi": 0, "estim": 0, "set_observ": 0, "set_observation_time_step": 0, "observation_time_step": 0, "step": 0, "set_gap": 0, "gap": 0, "between": 0, "set_num_ensembl": 0, "num_ensembl": 0, "set_start_tim": 0, "start_tim": 0, "float": 0, "start": 0, "set_arg": 0, "arg": 0, "tupl": 0, "addit": 0, "argument": 0, "set_optimizer_cl": 0, "optimizer_cl": 0, "optim": 0, "base": 0, "set_optimizer_arg": 0, "optimizer_arg": 0, "set_max_iter": 0, "max_iter": 0, "maximum": 0, "iter": 0, "set_record_log": 0, "record_log": 0, "bool": 0, "whether": 0, "record": 0, "print": 0, "log": 0, "messag": 0, "dure": 0, "list": 0, "return": 0, "result": 0, "get_results_dict": 0, "get": 0, "get_parameters_dict": 0, "static": 0, "check_covariance_matrix": 0, "cov_matrix": 0, "check": 0, "given": 0, "valid": 0, "rais": 0, "linalgerror": 0, "squar": 0, "symmetr": 0, "singular": 0, "get_result": 0, "specif": 0, "from": 0, "retriev": 0, "average_ensemble_all_st": 0, "when": 0, "each_ensemble_all_st": 0, "assimilated_st": 0, "var3d": 0, "var4d": 0, "intermediate_result": 0, "request": 0, "lambda": 0, "0": 0, "adamw": 0, "factori": 0, "1000": 0, "true": 0, "hold": 0, "encapsul": 0, "requir": 0, "relat": 0, "It": 0, "can": 0, "pre": 0, "defin": 0, "repres": 0, "uncertainti": 0, "predict": 0, "system": 0, "previou": 0, "rang": 0, "along": 0, "determin": 0, "arrai": 0, "increas": 0, "order": 0, "consecut": 0, "select": 0, "hyperparamet": 0, "lr": 0, "1e": 0, "3": 0, "progress": 0, "pass": 0, "ensur": 0, "ar": 0, "properli": 0, "compat": 0, "": 0, "should": 0, "have": 0, "point": 0, "control": 0, "high": 0, "level": 0, "integr": 0, "run": 0, "support": 0, "There": 0, "copi": 0, "set_input_paramet": 0, "updat": 0, "apply_3dvar": 0, "three": 0, "dimension": 0, "dynam": 0, "noisi": 0, "aim": 0, "find": 0, "minim": 0, "cost": 0, "combin": 0, "oper": 0, "signatur": 0, "state_dim": 0, "observation_dim": 0, "batch_siz": 0, "x_optim": 0, "obtain": 0, "intermedi": 0, "j": 0, "each": 0, "j_grad_norm": 0, "norm": 0, "gradient": 0, "typeerror": 0, "assum": 0, "appropri": 0, "seek": 0, "incorpor": 0, "both": 0, "apply_4dvar": 0, "time_ob": 0, "four": 0, "over": 0, "time_rang": 0, "vector": 0, "measurement_dim": 0, "row": 0, "jb": 0, "jo": 0, "apply_enkf": 0, "ne": 0, "p0": 0, "see": 0, "e": 0, "g": 0, "evensen": 0, "ocean": 0, "2003": 0, "eq": 0, "44": 0, "54": 0, "within": 0, "grad": 0, "context": 0, "mean": 0, "disabl": 0, "member": 0, "where": 0, "nois": 0, "x_ave": 0, "num_step": 0, "x_en": 0, "slice": 0, "second": 0, "distribut": 0, "apply_kf": 0, "constant": 0, "p": 0, "assumpt": 0, "calcul": 0, "current": 0, "x_estim": 0, "remain": 0, "same": 0, "throughout": 0, "vari": 0, "you": 0, "need": 0, "modifi": 0, "accordingli": 0, "set_early_stop": 0, "early_stop": 0, "earli": 0, "stop": 0, "criterion": 0, "early_stop_iter": 0, "absolute_toler": 0}, "objects": {"": [[0, 0, 0, "-", "torchda"]], "torchda": [[0, 1, 1, "", "CaseBuilder"], [0, 1, 1, "", "Parameters"], [0, 1, 1, "", "_Executor"], [0, 4, 1, "", "apply_3DVar"], [0, 4, 1, "", "apply_4DVar"], [0, 4, 1, "", "apply_EnKF"], [0, 4, 1, "", "apply_KF"]], "torchda.CaseBuilder": [[0, 2, 1, "", "case_name"], [0, 3, 1, "", "check_covariance_matrix"], [0, 3, 1, "", "execute"], [0, 3, 1, "", "get_parameters_dict"], [0, 3, 1, "", "get_result"], [0, 3, 1, "", "get_results_dict"], [0, 3, 1, "", "set_algorithm"], [0, 3, 1, "", "set_args"], [0, 3, 1, "", "set_background_covariance_matrix"], [0, 3, 1, "", "set_background_state"], [0, 3, 1, "", "set_device"], [0, 3, 1, "", "set_early_stop"], [0, 3, 1, "", "set_gaps"], [0, 3, 1, "", "set_max_iterations"], [0, 3, 1, "", "set_num_ensembles"], [0, 3, 1, "", "set_observation_covariance_matrix"], [0, 3, 1, "", "set_observation_time_steps"], [0, 3, 1, "", "set_observations"], [0, 3, 1, "", "set_optimizer_args"], [0, 3, 1, "", "set_optimizer_cls"], [0, 3, 1, "", "set_output_sequence_length"], [0, 3, 1, "", "set_parameter"], [0, 3, 1, "", "set_parameters"], [0, 3, 1, "", "set_record_log"], [0, 3, 1, "", "set_start_time"]], "torchda.Parameters": [[0, 2, 1, "", "algorithm"], [0, 2, 1, "", "args"], [0, 2, 1, "", "background_covariance_matrix"], [0, 2, 1, "", "background_state"], [0, 2, 1, "", "device"], [0, 2, 1, "", "early_stop"], [0, 2, 1, "", "forward_model"], [0, 2, 1, "", "gaps"], [0, 2, 1, "", "max_iterations"], [0, 2, 1, "", "num_ensembles"], [0, 2, 1, "", "observation_covariance_matrix"], [0, 2, 1, "", "observation_model"], [0, 2, 1, "", "observation_time_steps"], [0, 2, 1, "", "observations"], [0, 2, 1, "", "optimizer_args"], [0, 2, 1, "", "optimizer_cls"], [0, 2, 1, "", "output_sequence_length"], [0, 2, 1, "", "record_log"], [0, 2, 1, "", "start_time"]], "torchda._Executor": [[0, 3, 1, "", "get_result"], [0, 3, 1, "", "get_results_dict"], [0, 3, 1, "", "run"], [0, 3, 1, "", "set_input_parameters"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "function", "Python function"]}, "titleterms": {"us": 0, "deep": 0, "learn": 0, "data": 0, "assimil": 0, "torchda": 0, "modul": 0}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 58}, "alltitles": {"Use Deep Learning in Data Assimilation": [[0, "use-deep-learning-in-data-assimilation"]], "torchda": [[0, "torchda"]], "TorchDA": [[0, "id1"]], "Modules": [[0, "modules"]]}, "indexentries": {"casebuilder (class in torchda)": [[0, "torchda.CaseBuilder"]], "parameters (class in torchda)": [[0, "torchda.Parameters"]], "_executor (class in torchda)": [[0, "torchda._Executor"]], "algorithm (torchda.parameters attribute)": [[0, "torchda.Parameters.algorithm"]], "apply_3dvar() (in module torchda)": [[0, "torchda.apply_3DVar"]], "apply_4dvar() (in module torchda)": [[0, "torchda.apply_4DVar"]], "apply_enkf() (in module torchda)": [[0, "torchda.apply_EnKF"]], "apply_kf() (in module torchda)": [[0, "torchda.apply_KF"]], "args (torchda.parameters attribute)": [[0, "torchda.Parameters.args"]], "background_covariance_matrix (torchda.parameters attribute)": [[0, "torchda.Parameters.background_covariance_matrix"]], "background_state (torchda.parameters attribute)": [[0, "torchda.Parameters.background_state"]], "case_name (torchda.casebuilder attribute)": [[0, "torchda.CaseBuilder.case_name"]], "check_covariance_matrix() (torchda.casebuilder static method)": [[0, "torchda.CaseBuilder.check_covariance_matrix"]], "device (torchda.parameters attribute)": [[0, "torchda.Parameters.device"]], "early_stop (torchda.parameters attribute)": [[0, "torchda.Parameters.early_stop"]], "execute() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.execute"]], "forward_model (torchda.parameters attribute)": [[0, "torchda.Parameters.forward_model"]], "gaps (torchda.parameters attribute)": [[0, "torchda.Parameters.gaps"]], "get_parameters_dict() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.get_parameters_dict"]], "get_result() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.get_result"]], "get_result() (torchda._executor method)": [[0, "torchda._Executor.get_result"]], "get_results_dict() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.get_results_dict"]], "get_results_dict() (torchda._executor method)": [[0, "torchda._Executor.get_results_dict"]], "max_iterations (torchda.parameters attribute)": [[0, "torchda.Parameters.max_iterations"]], "module": [[0, "module-torchda"]], "num_ensembles (torchda.parameters attribute)": [[0, "torchda.Parameters.num_ensembles"]], "observation_covariance_matrix (torchda.parameters attribute)": [[0, "torchda.Parameters.observation_covariance_matrix"]], "observation_model (torchda.parameters attribute)": [[0, "torchda.Parameters.observation_model"]], "observation_time_steps (torchda.parameters attribute)": [[0, "torchda.Parameters.observation_time_steps"]], "observations (torchda.parameters attribute)": [[0, "torchda.Parameters.observations"]], "optimizer_args (torchda.parameters attribute)": [[0, "torchda.Parameters.optimizer_args"]], "optimizer_cls (torchda.parameters attribute)": [[0, "torchda.Parameters.optimizer_cls"]], "output_sequence_length (torchda.parameters attribute)": [[0, "torchda.Parameters.output_sequence_length"]], "record_log (torchda.parameters attribute)": [[0, "torchda.Parameters.record_log"]], "run() (torchda._executor method)": [[0, "torchda._Executor.run"]], "set_algorithm() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_algorithm"]], "set_args() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_args"]], "set_background_covariance_matrix() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_background_covariance_matrix"]], "set_background_state() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_background_state"]], "set_device() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_device"]], "set_early_stop() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_early_stop"]], "set_gaps() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_gaps"]], "set_input_parameters() (torchda._executor method)": [[0, "torchda._Executor.set_input_parameters"]], "set_max_iterations() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_max_iterations"]], "set_num_ensembles() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_num_ensembles"]], "set_observation_covariance_matrix() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_observation_covariance_matrix"]], "set_observation_time_steps() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_observation_time_steps"]], "set_observations() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_observations"]], "set_optimizer_args() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_optimizer_args"]], "set_optimizer_cls() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_optimizer_cls"]], "set_output_sequence_length() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_output_sequence_length"]], "set_parameter() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_parameter"]], "set_parameters() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_parameters"]], "set_record_log() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_record_log"]], "set_start_time() (torchda.casebuilder method)": [[0, "torchda.CaseBuilder.set_start_time"]], "start_time (torchda.parameters attribute)": [[0, "torchda.Parameters.start_time"]], "torchda": [[0, "module-torchda"]]}})